train <- anti_join(no.na, test)
mod <- lm(log(Rate.of.Misconducts..per.100.students.)~Average.Student.Attendance*ISAT.Exceeding.Math.., data = train)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*ISAT.Exceeding.Math.., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(ISAT.Exceeding.Math..^2), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(ISAT.Exceeding.Math..^(1/2)), data = train)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(ISAT.Exceeding.Math..^(.5)), data = train)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(ISAT.Exceeding.Math..^(1.5)), data = train)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~10^(Average.Student.Attendance)*(sqrt(ISAT.Exceeding.Math..)), data = train)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(10^(Average.Student.Attendance))*(sqrt(ISAT.Exceeding.Math..)), data = train)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(10^(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(10^(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(10^(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(10^(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(2^(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(sqrt(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(sqrt(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(sqrt(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I(sqrt(Average.Student.Attendance)))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I((Average.Student.Attendance)^2))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I((Average.Student.Attendance)^2))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~(I((Average.Student.Attendance)^2))*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~."))+Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..)), data= train.set)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~+Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train.set)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
#mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(mod, test)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, test)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, test, type="response")
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, test, type="response")
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, test, type="response")
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, test, type="response")
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, test, type="coefficient")
error <- predictions - test$Rate.of.Misconducts..per.100.students.
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, test, type="response")
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= test)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= test)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= test)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~.-", vrbl)), data=test)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
mean(error^2)
MSE.list <- rep(0, 50)
for(i in 1:50){
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
MSE.list[[i]] <- mean(error^2)
}
boxplot(MSE.list)
MSE.list <- rep(0, 50)
for(i in 1:50){
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*(ISAT.Exceeding.Math..)+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*(sqrt(ISAT.Exceeding.Math..))+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
MSE.list[[i]] <- mean(error^2)
}
MSE.list <- rep(0, 50)
for(i in 1:50){
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*ISAT.Exceeding.Math..+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*ISAT.Exceeding.Math..)+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
MSE.list[[i]] <- mean(error^2)
}
MSE.list <- rep(0, 50)
for(i in 1:50){
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*ISAT.Exceeding.Math..+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*ISAT.Exceeding.Math..)+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
MSE.list[[i]] <- mean(error^2)
}
MSE.list <- rep(0, 50)
for(i in 1:50){
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*ISAT.Exceeding.Math..+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*ISAT.Exceeding.Math..+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
MSE.list[[i]] <- mean(error^2)
}
boxplot(MSE.list)
MSE.list <- rep(0, 50)
for(i in 1:50){
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~(10^Average.Student.Attendance)*ISAT.Exceeding.Math..+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~(10^Average.Student.Attendance)*ISAT.Exceeding.Math..+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
MSE.list[[i]] <- mean(error^2)
}
MSE.list <- rep(0, 50)
for(i in 1:50){
test <- sample_n(no.na, 100)
train <- anti_join(no.na, test)
#Lasso Regression
modMatrix <- model.matrix(as.formula(paste("Rate.of.Misconducts..per.100.students.", "~Average.Student.Attendance*ISAT.Exceeding.Math..+.")), data= train)
lassoMod = cv.glmnet(modMatrix, y = train[,"Rate.of.Misconducts..per.100.students."], alpha = 1, nfolds = 5)
mod <- lm(Rate.of.Misconducts..per.100.students.~Average.Student.Attendance+(sqrt(ISAT.Exceeding.Math..))+., data = train)
newX <- model.matrix(as.formula(paste("~Average.Student.Attendance*ISAT.Exceeding.Math..+.-", "Rate.of.Misconducts..per.100.students.")), data=test)
predictions <- predict(lassoMod, s= lassoMod$lambda.min, newx= newX)
error <- predictions - test$Rate.of.Misconducts..per.100.students.
MSE.list[[i]] <- mean(error^2)
}
boxplot(MSE.list)
